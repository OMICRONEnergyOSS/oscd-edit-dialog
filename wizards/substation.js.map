{"version":3,"file":"substation.js","sources":["../../../wizards/substation.ts"],"sourcesContent":["import { html, TemplateResult } from 'lit';\n\nimport { getReference, updateSubstation } from '@openenergytools/scl-lib';\n\nimport {\n  createElement,\n  getValue,\n  reservedNames,\n  Wizard,\n  WizardActor,\n  WizardInputElement,\n} from '../foundation.js';\nimport { EditV2 } from '@omicronenergy/oscd-api';\n\ntype RenderOptions = {\n  name: string;\n  reservedValues: string[];\n  desc: string | null;\n};\n\nfunction render(options: RenderOptions): TemplateResult[] {\n  return [\n    html`<scl-text-field\n      label=\"name\"\n      .value=${options.name}\n      required\n      .reservedValues=\"${options.reservedValues}\"\n      dialogInitialFocus\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"desc\"\n      .value=${options.desc}\n      nullable\n    ></scl-text-field>`,\n  ];\n}\n\nexport function createAction(parent: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditV2[] => {\n    const name = getValue(inputs.find(i => i.label === 'name')!);\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n\n    parent.ownerDocument.createElement('Substation');\n    const substation = createElement(parent.ownerDocument, 'Substation', {\n      name,\n      desc,\n    });\n\n    return [\n      {\n        parent,\n        node: substation,\n        reference: getReference(parent, 'Substation'),\n      },\n    ];\n  };\n}\n\nexport function createSubstationWizard(parent: Element): Wizard {\n  return {\n    title: 'Create Substation',\n    primary: {\n      icon: 'add',\n      label: 'add',\n      action: createAction(parent),\n    },\n    content: render({\n      name: '',\n      reservedValues: reservedNames(parent, 'Substation'),\n      desc: '',\n    }),\n  };\n}\n\nexport function updateAction(element: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditV2[] => {\n    const name = inputs.find(i => i.label === 'name')!.value!;\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n\n    if (\n      name === element.getAttribute('name') &&\n      desc === element.getAttribute('desc')\n    ) {\n      return [];\n    }\n\n    return updateSubstation({ element, attributes: { name, desc } });\n  };\n}\n\nexport function editSubstationWizard(element: Element): Wizard {\n  return {\n    title: 'Edit Substation',\n    primary: {\n      icon: 'edit',\n      label: 'save',\n      action: updateAction(element),\n    },\n    content: render({\n      name: element.getAttribute('name') ?? '',\n      reservedValues: reservedNames(element),\n      desc: element.getAttribute('desc'),\n    }),\n  };\n}\n"],"names":["html"],"mappings":";;;;;;;;;;;;;;AAoBA,SAAS,MAAM,CAAC,OAAsB,EAAA;IACpC,OAAO;AACL,QAAAA,CAAI,CAAA,CAAA;;AAEO,aAAA,EAAA,OAAO,CAAC,IAAI;;AAEF,uBAAA,EAAA,OAAO,CAAC,cAAc,CAAA;;AAExB,sBAAA,CAAA;AACnB,QAAAA,CAAI,CAAA,CAAA;;AAEO,aAAA,EAAA,OAAO,CAAC,IAAI;;AAEJ,sBAAA,CAAA;KACpB;AACH;AAEM,SAAU,YAAY,CAAC,MAAe,EAAA;IAC1C,OAAO,CAAC,MAA4B,KAAc;AAChD,QAAA,MAAM,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,CAAE,CAAC;AAC5D,QAAA,MAAM,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,CAAE,CAAC;AAE5D,QAAA,MAAM,CAAC,aAAa,CAAC,aAAa,CAAC,YAAY,CAAC;QAChD,MAAM,UAAU,GAAG,aAAa,CAAC,MAAM,CAAC,aAAa,EAAE,YAAY,EAAE;YACnE,IAAI;YACJ,IAAI;AACL,SAAA,CAAC;QAEF,OAAO;AACL,YAAA;gBACE,MAAM;AACN,gBAAA,IAAI,EAAE,UAAU;AAChB,gBAAA,SAAS,EAAE,YAAY,CAAC,MAAM,EAAE,YAAY,CAAC;AAC9C,aAAA;SACF;AACH,IAAA,CAAC;AACH;AAEM,SAAU,sBAAsB,CAAC,MAAe,EAAA;IACpD,OAAO;AACL,QAAA,KAAK,EAAE,mBAAmB;AAC1B,QAAA,OAAO,EAAE;AACP,YAAA,IAAI,EAAE,KAAK;AACX,YAAA,KAAK,EAAE,KAAK;AACZ,YAAA,MAAM,EAAE,YAAY,CAAC,MAAM,CAAC;AAC7B,SAAA;QACD,OAAO,EAAE,MAAM,CAAC;AACd,YAAA,IAAI,EAAE,EAAE;AACR,YAAA,cAAc,EAAE,aAAa,CAAC,MAAM,EAAE,YAAY,CAAC;AACnD,YAAA,IAAI,EAAE,EAAE;SACT,CAAC;KACH;AACH;AAEM,SAAU,YAAY,CAAC,OAAgB,EAAA;IAC3C,OAAO,CAAC,MAA4B,KAAc;AAChD,QAAA,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,CAAE,CAAC,KAAM;AACzD,QAAA,MAAM,IAAI,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,CAAE,CAAC;AAE5D,QAAA,IACE,IAAI,KAAK,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC;YACrC,IAAI,KAAK,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,EACrC;AACA,YAAA,OAAO,EAAE;QACX;AAEA,QAAA,OAAO,gBAAgB,CAAC,EAAE,OAAO,EAAE,UAAU,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC;AAClE,IAAA,CAAC;AACH;AAEM,SAAU,oBAAoB,CAAC,OAAgB,EAAA;IACnD,OAAO;AACL,QAAA,KAAK,EAAE,iBAAiB;AACxB,QAAA,OAAO,EAAE;AACP,YAAA,IAAI,EAAE,MAAM;AACZ,YAAA,KAAK,EAAE,MAAM;AACb,YAAA,MAAM,EAAE,YAAY,CAAC,OAAO,CAAC;AAC9B,SAAA;QACD,OAAO,EAAE,MAAM,CAAC;YACd,IAAI,EAAE,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC,IAAI,EAAE;AACxC,YAAA,cAAc,EAAE,aAAa,CAAC,OAAO,CAAC;AACtC,YAAA,IAAI,EAAE,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC;SACnC,CAAC;KACH;AACH;;;;"}