{"version":3,"file":"powertransformer.js","sources":["../../../wizards/powertransformer.ts"],"sourcesContent":["import { html, TemplateResult } from 'lit';\n\nimport { EditV2 } from '@omicronenergy/oscd-api';\nimport { getReference } from '@openenergytools/scl-lib';\n\nimport {\n  createElement,\n  getValue,\n  reservedNames,\n  Wizard,\n  WizardActor,\n  WizardInputElement,\n} from '../foundation.js';\n\nconst defaultPowerTransformerType = 'PTR';\n\ntype RenderOptions = {\n  name: string | null;\n  desc: string | null;\n  type: string | null;\n  reservedValues: string[];\n};\n\nfunction renderPowerTransformerWizard(\n  options: RenderOptions,\n): TemplateResult[] {\n  return [\n    html`<scl-text-field\n      label=\"name\"\n      .value=${options.name}\n      required\n      dialogInitialFocus\n      .reservedValues=${options.reservedValues}\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"desc\"\n      .value=${options.desc}\n      nullable\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"type\"\n      .value=${options.type}\n      disabled\n    ></scl-text-field>`,\n  ];\n}\n\nfunction createAction(parent: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditV2[] => {\n    const name = getValue(inputs.find(i => i.label === 'name')!);\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n    const powerTransformer = createElement(\n      parent.ownerDocument,\n      'PowerTransformer',\n      {\n        name,\n        desc,\n        type: defaultPowerTransformerType,\n      },\n    );\n\n    return [\n      {\n        parent,\n        node: powerTransformer,\n        reference: getReference(parent, 'PowerTransformer'),\n      },\n    ];\n  };\n}\n\nexport function createPowerTransformerWizard(parent: Element): Wizard {\n  return {\n    title: 'Add PowerTransformer',\n    primary: {\n      icon: '',\n      label: 'add',\n      action: createAction(parent),\n    },\n    content: renderPowerTransformerWizard({\n      name: '',\n      reservedValues: reservedNames(parent, 'PowerTransformer'),\n      desc: null,\n      type: defaultPowerTransformerType,\n    }),\n  };\n}\n\nfunction updateAction(element: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditV2[] => {\n    const name = inputs.find(i => i.label === 'name')!.value!;\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n\n    if (\n      name === element.getAttribute('name') &&\n      desc === element.getAttribute('desc')\n    ) {\n      return [];\n    }\n\n    return [{ element, attributes: { name, desc } }];\n  };\n}\n\nexport function editPowerTransformerWizard(element: Element): Wizard {\n  return {\n    title: 'Edit PowerTransformer',\n    primary: {\n      icon: 'edit',\n      label: 'save',\n      action: updateAction(element),\n    },\n    content: renderPowerTransformerWizard({\n      name: element.getAttribute('name'),\n      reservedValues: reservedNames(element),\n      desc: element.getAttribute('desc'),\n      type: element.getAttribute('type'),\n    }),\n  };\n}\n"],"names":["html"],"mappings":"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"}