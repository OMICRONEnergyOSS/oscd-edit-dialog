{"version":3,"file":"sdo.js","sources":["../../../wizards/sdo.ts"],"sourcesContent":["import { html, TemplateResult } from 'lit';\n\nimport { EditV2 } from '@openscd/oscd-api';\n\nimport { getReference } from '@openscd/scl-lib';\n\nimport {\n  createElement,\n  getValue,\n  Wizard,\n  WizardActor,\n  WizardInputElement,\n} from '../foundation.js';\nimport { patterns } from './patterns.js';\n\ntype DoContent = {\n  name: string | null;\n  desc: string | null;\n  type: string | null;\n  doTypes: Element[];\n};\n\nfunction renderContent(content: DoContent): TemplateResult[] {\n  return [\n    html`<scl-text-field\n      label=\"name\"\n      .value=${content.name}\n      required\n      pattern=\"${patterns.alphanumericFirstLowerCase}\"\n      dialogInitialFocus\n      disabled\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"desc\"\n      .value=${content.desc}\n      nullable\n      pattern=\"${patterns.normalizedString}\"\n    ></scl-text-field>`,\n    html`<scl-select\n      label=\"type\"\n      required\n      .selectOptions=${content.doTypes.map(dataType => dataType.id)}\n      .value=${content.type}\n      disabled\n    ></scl-select>`,\n  ];\n}\n\nfunction createSDoAction(parent: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditV2[] => {\n    const name = getValue(inputs.find(i => i.label === 'name')!)!;\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n    const type = getValue(inputs.find(i => i.label === 'type')!);\n\n    const actions: EditV2 = [];\n\n    const element = createElement(parent.ownerDocument, 'SDO', {\n      name,\n      desc,\n      type,\n    });\n\n    actions.push({\n      parent,\n      node: element,\n      reference: getReference(parent, 'SDO'),\n    });\n\n    return actions;\n  };\n}\n\nexport function createSDoWizard(parent: Element): Wizard {\n  const [type, name, desc] = [null, '', null];\n\n  const doTypes = Array.from(\n    parent.ownerDocument.querySelectorAll('DOType'),\n  ).filter(doType => doType.getAttribute('id'));\n\n  return {\n    title: 'Add SDO',\n    primary: { icon: '', label: 'save', action: createSDoAction(parent) },\n    content: renderContent({\n      name,\n      desc,\n      type,\n      doTypes,\n    }),\n  };\n}\n\nfunction updateSDoAction(element: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditV2[] => {\n    const name = getValue(inputs.find(i => i.label === 'name')!)!;\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n    const type = getValue(inputs.find(i => i.label === 'type')!)!;\n\n    if (\n      name === element.getAttribute('name') &&\n      desc === element.getAttribute('desc') &&\n      type === element.getAttribute('type')\n    ) {\n      return [];\n    }\n\n    return [{ element, attributes: { name, desc, type } }];\n  };\n}\n\nexport function editSDoWizard(element: Element): Wizard {\n  const [type, name, desc] = [\n    element.getAttribute('type'),\n    element.getAttribute('name'),\n    element.getAttribute('desc'),\n  ];\n\n  const doTypes = Array.from(\n    element.ownerDocument.querySelectorAll('DOType'),\n  ).filter(doType => doType.getAttribute('id'));\n\n  return {\n    title: 'Edit SDO',\n    primary: { icon: '', label: 'save', action: updateSDoAction(element) },\n    content: renderContent({\n      name,\n      desc,\n      type,\n      doTypes,\n    }),\n  };\n}\n"],"names":["html"],"mappings":"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"}