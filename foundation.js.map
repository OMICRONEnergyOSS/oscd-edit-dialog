{"version":3,"file":"foundation.js","sources":["../../foundation.ts"],"sourcesContent":["import { TemplateResult } from 'lit';\n\nimport { EditV2 } from '@omicronenergy/oscd-api';\nimport { MdFilledSelect } from '@scopedelement/material-web/select/MdFilledSelect';\nimport { MdFilledTextField } from '@scopedelement/material-web/textfield/MdFilledTextField';\nimport { SclCheckbox } from '@openenergytools/scl-checkbox';\nimport { SclSelect } from '@openenergytools/scl-select';\nimport { SclTextField } from '@openenergytools/scl-text-field';\n\nexport type WizardInputElement =\n  | SclTextField\n  | SclSelect\n  | SclCheckbox\n  | MdFilledTextField\n  | MdFilledSelect;\n\nexport type WizardActor = (\n  inputs: WizardInputElement[],\n  wizard: Element,\n) => EditV2[];\n\nexport interface Wizard {\n  title: string;\n  content?: TemplateResult[];\n  primary?: {\n    icon: string;\n    label: string;\n    action: WizardActor;\n    auto?: boolean;\n  };\n  secondary?: {\n    icon: string;\n    label: string;\n  };\n}\n\n/** @returns the `value` or `maybeValue` of `input` depending on type. */\nexport function getValue(input: WizardInputElement): string | null {\n  return input.value;\n}\n\n/** @returns a new [[`tag`]] element owned by [[`doc`]]. */\nexport function createElement(\n  doc: Document,\n  tag: string,\n  attrs: Record<string, string | null>,\n): Element {\n  const element = doc.createElementNS(doc.documentElement.namespaceURI, tag);\n  Object.entries(attrs)\n    .filter(([_, value]) => value !== null)\n    .forEach(([name, value]) => element.setAttribute(name, value!));\n  return element;\n}\n\nexport function getChildElementsByTagName(\n  parent: Element | null | undefined,\n  tag: string | null | undefined,\n): Element[] {\n  if (!parent || !tag) {\n    return [];\n  }\n  return Array.from(parent.children).filter(element => element.tagName === tag);\n}\n\n/** @returns reserved siblings names attributes */\nexport function reservedNames(element: Element, tagName?: string): string[] {\n  if (tagName) {\n    return getChildElementsByTagName(element, tagName).map(\n      sibling => sibling.getAttribute('name')!,\n    );\n  }\n\n  if (!element.parentElement) {\n    return [];\n  }\n  return getChildElementsByTagName(element.parentElement, element.tagName)\n    .filter(sibling => sibling !== element)\n    .map(sibling => sibling.getAttribute('name')!);\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function isSclTextfield(type: any): type is SclTextField {\n  return 'value' in type && 'multiplier' in type;\n}\n\n/** @returns the `multiplier` of `input` if available. */\nexport function getMultiplier(input: WizardInputElement): string | null {\n  if (isSclTextfield(input)) {\n    return input.multiplier;\n  }\n  return null;\n}\n\n/** @returns a clone of `element` with attributes set to values from `attrs`. */\nexport function cloneElement(\n  element: Element,\n  attrs: Record<string, string | null>,\n): Element {\n  const newElement = <Element>element.cloneNode(false);\n  Object.entries(attrs).forEach(([name, value]) => {\n    if (value === null) {\n      newElement.removeAttribute(name);\n    } else {\n      newElement.setAttribute(name, value);\n    }\n  });\n  return newElement;\n}\n\n/** @returns the cartesian product of `arrays` */\nexport function crossProduct<T>(...arrays: T[][]): T[][] {\n  return arrays.reduce<T[][]>(\n    (a, b) => <T[][]>a.flatMap(d => b.map(e => [d, e].flat())),\n    [[]],\n  );\n}\n\n/** Whether `P` element is required within `Address` */\nexport const typeNullable: Partial<Record<string, boolean>> = {\n  IP: false,\n  'IP-SUBNET': false,\n  'IP-GATEWAY': true,\n  'OSI-TSEL': true,\n  'OSI-SSEL': true,\n  'OSI-PSEL': true,\n  'OSI-AP-Title': true,\n  'OSI-AP-Invoke': true,\n  'OSI-AE-Qualifier': true,\n  'OSI-AE-Invoke': true,\n  'OSI-NSAP': true,\n  'MAC-Address': false,\n  APPID: false,\n  'VLAN-ID': true,\n  'VLAN-PRIORITY': true,\n  'SNTP-Port': true,\n  'MMS-Port': true,\n  DNSName: true,\n  'UDP-Port': true,\n  'TCP-Port': true,\n  'C37-118-IP-Port': true,\n  IPv6: true,\n  'IPv6-SUBNET': true,\n  'IPv6-GATEWAY': true,\n  IPv6FlowLabel: true,\n  IPv6ClassOfTraffic: true,\n  'IPv6-IGMPv3Src': true,\n  'IP-IGMPv3Sr': true,\n  'IP-ClassOfTraffic': true,\n};\n\nexport function getTypes(element: Element): string[] {\n  if (!element.ownerDocument.documentElement) {\n    return [];\n  }\n\n  const pTypes2003: string[] = [\n    'IP',\n    'IP-SUBNET',\n    'IP-GATEWAY',\n    'OSI-TSEL',\n    'OSI-SSEL',\n    'OSI-PSEL',\n    'OSI-AP-Title',\n    'OSI-AP-Invoke',\n    'OSI-AE-Qualifier',\n    'OSI-AE-Invoke',\n    'OSI-NSAP',\n    'VLAN-ID',\n    'VLAN-PRIORITY',\n  ];\n\n  const pTypes2007B: string[] = [\n    ...pTypes2003,\n    'SNTP-Port',\n    'MMS-Port',\n    'DNSName',\n    'UDP-Port',\n    'TCP-Port',\n    'C37-118-IP-Port',\n  ];\n\n  const pTypes2007B4: string[] = [\n    ...pTypes2007B,\n    'IPv6',\n    'IPv6-SUBNET',\n    'IPv6-GATEWAY',\n    'IPv6FlowLabel',\n    'IPv6ClassOfTraffic',\n    'IPv6-IGMPv3Src',\n    'IP-IGMPv3Sr',\n    'IP-ClassOfTraffic',\n  ];\n\n  const scl: Element = element.ownerDocument.documentElement;\n\n  const type =\n    (scl.getAttribute('version') ?? '2003') +\n    (scl.getAttribute('revision') ?? '') +\n    (scl.getAttribute('release') ?? '');\n\n  if (type === '2003') {\n    return pTypes2003;\n  }\n\n  if (type === '2007B') {\n    return pTypes2007B;\n  }\n\n  return pTypes2007B4;\n}\n\n/** Sorts selected `ListItem`s to the top and disabled ones to the bottom. */\nexport function compareNames(a: Element | string, b: Element | string): number {\n  if (typeof a === 'string' && typeof b === 'string') {\n    return a.localeCompare(b);\n  }\n\n  if (typeof a === 'object' && typeof b === 'string') {\n    return (a.getAttribute('name') ?? '').localeCompare(b);\n  }\n\n  if (typeof a === 'string' && typeof b === 'object') {\n    return a.localeCompare(b.getAttribute('name')!);\n  }\n\n  if (typeof a === 'object' && typeof b === 'object') {\n    return (a.getAttribute('name') ?? '').localeCompare(\n      b.getAttribute('name') ?? '',\n    );\n  }\n\n  return 0;\n}\n"],"names":[],"mappings":"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"}